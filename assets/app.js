
(() => {
  const DATA = {"meta": {"title": "Mutter Courage und ihre Kinder – UE interaktiv", "source": "Lehrerexemplar"}, "sections": [{"id": "historisch", "title": "Historischer & geografischer Hintergrund", "ref": "Lehrer-PDF S.3–4", "intro": "Notiere Jahreszahlen und Stationen der Wanderung; erkenne historische Bezüge und Berührungen zu Heereszügen.", "questions": [{"id": "hist1", "type": "tableFill", "title": "1) Jahreszahlen & Stationen (Vorspanntexte)", "prompt": "Ergänze die Stationen (1–12) mit Jahr und Ort. (Form: Jahr – Ort/Region).", "rows": [["1", "1624 – Dalarne in Schweden"], ["2", "1625/26 – Polen und Festung Wallhof bei Riga"], ["3/4", "1629 – Polen"], ["5", "1631 – Polen, Mähren, Bayern, Italien, wieder Bayern und Magdeburg"], ["6–8", "1632 – Ingolstadt (Bayern)"], ["9", "1634 – Fichtelgebirge (Bayern)"], ["10", "1635 – Mitteldeutschland (Sachsen-Anhalt)"], ["11/12", "1636 – Halle (Sachsen-Anhalt)"]], "hint": "Die Lösung ist eine Liste (1,2,3/4,5,6–8,9,10,11/12) mit Jahr(en) und Orten.", "solution": "1 1624 Dalarne in Schweden\n2 1625/26 Polen und Festung Wallhof bei Riga\n3/4 1629 Polen\n5 1631 Polen, Mähren, Bayern, Italien, wieder Bayern und Magdeburg\n6–8 1632 Ingolstadt (Bayern)\n9 1634 Fichtelgebirge (Bayern)\n10 1635 Mitteldeutschland (Sachsen-Anhalt)\n11/12 1636 Halle (Sachsen-Anhalt)", "check": "exactLines"}, {"id": "hist2", "type": "multiSelect", "title": "2) Szenen mit historischen Fakten", "prompt": "Wähle die Szenen aus, in denen konkrete historische Fakten genannt werden.", "options": ["1. Szene", "2. Szene", "3. Szene", "4. Szene", "5. Szene", "6. Szene", "7. Szene", "8. Szene", "9. Szene", "10. Szene", "11. Szene", "12. Szene"], "answer": ["1. Szene", "2. Szene", "5. Szene", "6. Szene", "8. Szene"], "hint": "Es sind 5 Szenen (1,2,5,6,8).", "solution": "1. Szene: Eroberung Rigas 1621 / Feldhauptmann Oxenstjerna.\n2. Szene: Sieg Schwedens über Polen bei Riga (Wallhof) 1626.\n5. Szene: Zerstörung Magdeburgs durch Tilly 1631.\n6. Szene: Tod Tillys bei Rain/Ingolstadt 1632.\n8. Szene: Tod Gustav Adolfs bei Lützen 1632 (Frieden bedroht Courages Geschäft)."}, {"id": "hist3", "type": "textarea_keywords", "title": "3) Berührungen Heereszüge ↔ Wanderwege", "prompt": "Beschreibe die Berührungen zwischen realen Heereszügen und Mutter Courages Wanderwegen (kurz, stichwortartig).", "keywords": [["1. szene", "riga", "1621", "geschützfeuer"], ["2. szene", "schwed", "wallhof", "riga", "polen"], ["5. szene", "kaiserlich", "tilly", "wallenstein", "süddeutschland", "magdeburg"], ["6. szene", "begräbnis", "tilly"], ["8. szene", "schwed", "mitteldeutschland", "sachsen"]], "hint": "Erwarte Hinweise zu 1,2,5,6,8 (Riga/Wallhof/Polen; Süddeutschland+Magdeburg; Begräbnis Tilly; Schweden in Mitteldeutschland/Sachsen).", "solution": "1. Szene: Jahr 1621 – Geschützfeuer von Riga.\n2. Szene: mit dem schwedischen (protestantischen) Heer vor Wallhof bei Riga und in Polen.\n5. Szene: mit dem kaiserlichen Heer (kath./mit Tilly und Wallenstein) in Süddeutschland und Magdeburg.\n6. Szene: Begräbnis Tillys.\n8. Szene: mit dem schwedischen Heer in Mitteldeutschland und in Sachsen.\nFazit: fiktive Handlung in authentischem Kontext."}]}, {"id": "krieg30", "title": "Der Dreissigjährige Krieg", "ref": "Lehrer-PDF S.5", "intro": "Grundwissen zum 30-jährigen Krieg: Konfliktarten, Akteure, Folgen, Ende.", "questions": [{"id": "krieg30_1", "type": "clozeMC", "title": "Kurzcheck: Eckdaten", "prompt": "Beantworte die vier kurzen Fragen.", "items": [{"q": "Zeitraum? (Jahr–Jahr)", "a": ["1618-1648", "1618–1648", "1618 bis 1648"], "hint": "Beginnt 1618, endet 1648.", "sol": "1618 bis 1648"}, {"q": "Doppelnatur des Konflikts?", "a": [["hegemoni", "gleichgewicht"], ["religionskrieg"]], "hint": "Hegemonie/Gleichgewicht + Religionskrieg.", "sol": "Konflikt um Hegemonie bzw. Gleichgewicht der Mächte Europas und zugleich Religionskrieg."}, {"q": "Zwei Bündnisse im Reich?", "a": [["katholische liga"], ["protestantische union"]], "hint": "Katholische Liga ↔ Protestantische Union.", "sol": "Katholische Liga und Protestantische Union."}, {"q": "Friedensschluss (Datum)?", "a": ["24. oktober 1648", "24.10.1648"], "hint": "Westfälischer Frieden, Oktober 1648.", "sol": "24. Oktober 1648 (Westfälischer Frieden)."}]}]}, {"id": "bio", "title": "Biografischer Hintergrund", "ref": "Lehrer-PDF S.6", "intro": "Vergleiche Brechts Fluchtweg mit Courages Wanderweg: Anlass, Richtung, Ziel, Ergebnis.", "questions": [{"id": "bio1", "type": "textarea_keywords", "title": "Vergleich: Brecht vs. Courage", "prompt": "Arbeite heraus: Anlass, Verlauf (Richtung), Ziel, Ergebnis. (4 kurze Abschnitte / Stichworte).", "keywords": [["reziprok", "skandinav", "deutschland"], ["krieg", "nazis", "flieht", "freiwillig", "folgt"], ["leben retten", "schriftsteller", "wirken", "marketenderhandel", "durchbringen"], ["zuflucht", "ruhe", "sicherheit", "verliert ihre kinder", "elend", "nichts"]], "hint": "Wichtig: reziproke Wege; Brecht flieht vor Nazis, Courage folgt freiwillig; Ziele unterschiedlich; Ergebnisse gegensätzlich (Sicherheit vs. Verlust/Elend).", "solution": "Wege: Courage von Skandinavien nach Deutschland, Brecht von Deutschland nach Skandinavien (reziprok).\nAnlass: Krieg (Brecht: Flucht vor Nazis/deutschen Truppen; Courage folgt den Heeren freiwillig).\nZiel: Brecht will Leben retten und weiter schreiben; Courage will Familie mit Marketenderhandel durchbringen.\nErgebnis: Brecht findet Zuflucht/Ruhe/Sicherheit; Courage verliert die Kinder, gerät ins Elend und „verliert sich ins Nichts“."}]}, {"id": "ambivalenz", "title": "Ambivalenz: Mutter & Händlerin", "ref": "Lehrer-PDF S.7", "intro": "Name „Mutter Courage“, Bewertung ihres Verhaltens und dialektischer Widerspruch.", "questions": [{"id": "amb1", "type": "shorttext", "title": "Wie entstand der Name „Mutter Courage“?", "prompt": "Formuliere den Ursprung des Namens (1 Satz).", "answer": ["Sie ist mit fünfzig Brotlaiben im Wagen durch das Geschützfeuer von Riga gefahren", "Mit fünfzig Brotlaiben im Wagen durch Geschützfeuer von Riga"], "hint": "Stichworte: fünfzig Brotlaibe – Wagen – Geschützfeuer – Riga.", "solution": "Sie ist mit fünfzig Brotlaiben im Wagen durch das Geschützfeuer von Riga gefahren."}, {"id": "amb2", "type": "textarea_keywords", "title": "Wie beurteilst du Courages Verhalten? (Dialektik)", "prompt": "Fasse das Spannungsfeld zusammen: Mutterliebe ↔ Geschäftsinteresse.", "keywords": [["setzt", "leben aufs spiel"], ["todesgefahr", "kinder"], ["wirtschaftlichen ruin", "händlerin", "geschäft"], ["geschäftsfrau", "weil sie mutter ist", "kann nicht mutter sein", "weil sie geschäftsfrau ist"]], "hint": "Kern: Sie riskiert Leben, um nicht wirtschaftlich zu ruinieren; Dialektik-Satz wörtlich/inhaltlich.", "solution": "Sie setzt als Mutter für ihre Kinder ihr Leben aufs Spiel und bringt damit ihre Kinder in Todesgefahr, um als Händlerin nicht in den wirtschaftlichen Ruin zu geraten. Brecht’sche Dialektik: „Die Courage ist Geschäftsfrau, weil sie Mutter ist; sie kann nicht Mutter sein, weil sie Geschäftsfrau ist.“"}, {"id": "amb3", "type": "tableFill", "title": "Widersprüchliche Verhaltensweisen ergänzen", "prompt": "Ergänze die 5 Sätze (als Mutter … aber als Händlerin …).", "rows": [["A", "Mutter Courage verteidigt zwar ihre Söhne gegen die Werber mit dem Messer, verliert aber Eilif wegen des Verkaufs einer kleinen Schnalle."], ["B", "Sie will Schweizerkas’ Leben retten, aber Schweizerkas wird hingerichtet, weil sie ihren Wagen behalten will, zu lange um den Kopfpreis feilscht und die Hure Yvette als Unterhändlerin vorschickt."], ["C", "Sie tarnt Kattrin gegen Vergewaltigung, doch vor Ingolstadt muss Kattrin um Waren zu holen allein in die von Soldaten überfüllte Stadt gehen, wo sie überfallen und entstellt wird."], ["D", "Als Eilif zur Exekution geführt wird, merkt Courage nichts davon, weil sie gerade in Geschäften fort ist."], ["E", "Sie verlässt Kattrin nicht und geht nicht mit dem Koch nach Utrecht, vor Halle aber lässt Courage Kattrin alleine und macht Einkäufe in der Stadt, während Kattrin die Stadt Halle warnt und erschossen wird."]], "hint": "Die Lösungen sind vollständige Sätze pro Buchstabe (A–E).", "solution": "A: ... wegen des Verkaufs einer kleinen Schnalle.\nB: ... weil sie ihren Wagen behalten will, zu lange feilscht und Yvette vorschickt.\nC: ... Kattrin muss allein in die soldatenüberfüllte Stadt, wird überfallen/entstellt.\nD: ... merkt nichts, weil sie in Geschäften fort ist.\nE: ... lässt Kattrin allein einkaufen; Kattrin warnt Halle und wird erschossen.", "check": "exactLines"}]}, {"id": "rettung", "title": "Rettungsversuch Schweizerkas", "ref": "Lehrer-PDF S.8", "intro": "Stationen des Rettungsversuchs + Zitate; Bewertung.", "questions": [{"id": "rett1", "type": "tableFill", "title": "Stationen & Zitate (8 Schritte)", "prompt": "Ergänze die 8 Stationen des Rettungsversuchs inkl. aussagekräftigem Zitat.", "rows": [["1", "verleugnet den Sohn bei der Festnahme — „Wie soll ich ihn kennen?“ (S. 44)"], ["2", "will den Marketenderwagen verpfänden, um mit dem Geld den Sohn für 200 Gulden auszulösen — „verpfänden, nicht verkaufen, nur nix verschenken, so ein Wagen kauft sich nicht leicht wieder in vier Jahren.“ (S. 47)"], ["3", "verachtet das harte geschäftliche Verhalten der Yvette — „Du Hyänenvieh, es geht um Schweizerkas.“ (S. 49)"], ["4", "spekuliert auf die Regimentskasse, um damit den Wagen auslösen zu können — „Ich rechne mit der Regimentskasse.“ (S. 49)"], ["5", "als sie erfährt, dass die Regimentskasse im Fluss liegt, will sie für Schweizerkas nur noch 120 Gulden zahlen — „mit achtzig Gulden könnten wir eine Hucke mit Waren voll packen und von vorn anfangen.“ (S. 51)"], ["6", "als sie erfährt, dass Schweizerkas nur für 200 Gulden freigelassen wird, ist sie bereit 200 zu geben, doch der Sohn ist bereits tot — „mir scheint ich hab zu lang gehandelt!“ (S. 52)"], ["7", "kann jetzt ihren Wagen behalten — „Jetzt haben Sie es geschafft mitn Handel und daß Sie Ihren Wagen behalten. Elf Kugeln hat er gekriegt, sonst nix.“ (S. 52)"], ["8", "verleugnet den toten Sohn — „Gebt ihn auf den Schindanger, er hat keinen, der ihn kennt.“"]], "hint": "Orientiere dich an 8 Stationen (1: verleugnet – 2: verpfänden – 3: Yvette – 4: Regimentskasse – 5: 120 Gulden – 6: zu lang gehandelt – 7: Wagen behalten – 8: verleugnet toten Sohn).", "solution": "(siehe Tabelle im Lehrerexemplar S.8)", "check": "exactLines"}, {"id": "rett2", "type": "textarea_keywords", "title": "Bewertung", "prompt": "Bewerte Courages Verhalten (2–5 Sätze).", "keywords": [["feilsch", "wagen", "geschäft"], ["mutter", "retten", "aber"], ["mitverantwort", "schuld", "tragisch", "ambivalent"]], "hint": "Stichworte: Ambivalenz; Feilschen/Wagen/Kommerz; tragische Mitverantwortung.", "solution": "Modell: Courages Handeln ist tragisch ambivalent: Sie versucht zu retten, bleibt aber im Denken der Händlerin gefangen. Das lange Feilschen und das Festhalten am Wagen führen dazu, dass Schweizerkas zu spät freikommt. Damit wird sichtbar, wie der Krieg/Kommerz moralisches Handeln korrumpiert."}]}, {"id": "niedergang", "title": "Niedergang der Familie Fierling", "ref": "Lehrer-PDF S.9", "intro": "Beschreibe die abgebildeten Situationen und Ursachen der Veränderungen (Szenen 1,7,8,10,12).", "questions": [{"id": "nie1", "type": "textarea_keywords", "title": "Situationen & Ursachen (Bilder)", "prompt": "Beschreibe die Veränderungen der Ausgangsposition (Planwagen/Familie) bis zum Schluss (Halle) und nenne Ursachen.", "keywords": [["1. szene", "eilif", "schweizerkas"], ["7. szene", "schweizerkas", "kattrin"], ["8. szene", "koch", "kattrin"], ["10. szene", "mutter courage", "kattrin"], ["12. szene", "mutter courage", "allein"], ["krieg", "verlust", "handel", "elend"]], "hint": "Erwähne die Szenenfolge (1: Eilif+Schweizerkas; 7: Schweizerkas+Kattrin; 8: Koch+Kattrin; 10: Courage+Kattrin; 12: Courage allein) und die Kriegsursachen.", "solution": "Die Ausgangsposition (1. Szene) zeigt noch eine intakte Familie (Eilif und Schweizerkas). Schrittweise bricht die Familie: Nach Schweizerkas’ Tod bleiben nur noch Courage und Kattrin (7./10. Szene), zeitweise ergänzt durch den Koch (8. Szene). Am Ende (12. Szene) ist Courage allein. Ursache: Der Krieg zerstört Familie und Handel (Tod der Kinder, Verarmung/Ermüdung, Zerstörung/Flucht)."}]}, {"id": "kinder", "title": "Mutter Courages Kinder", "ref": "Lehrer-PDF S.10–12", "intro": "Eilif (Widerspruch), Schweizerkas (Irrtum), Kattrin (Gegenspielerin) + Gegensätze.", "questions": [{"id": "eilif1", "type": "tableFill", "title": "Eilif: Widerspruch Erziehung ↔ Lebensziel", "prompt": "Fülle die 3 Zeilen (Mutter Courage ↔ Eilif) aus.", "rows": [["Zeile 1", "Mutter: Erziehung gegen das Kriegshandwerk — „Meine Kinder sind nicht für das Kriegshandwerk“  |  Eilif: Bewunderung des Heerführers Gustav Adolf — „Ich möchte ihn mir zum Vorbild nehmen“"], ["Zeile 2", "Mutter: Ermahnung zur Vorsicht, um zu überleben — „Hab ich dir nicht gelernt, dass du auf dich achtgeben sollst?“  |  Eilif: Lust am Raufen/Gefahrenrisiko — „Mutter, darf ich ihm aufs Maul hauen? Ich möchte gern.“ (+ Lied vom Weib und den Soldaten)"], ["Zeile 3", "Mutter: Appell zur Zurückhaltung/Selbstverleumdung — „Klug ist, wenn du bei deiner Mutter bleibst…“  |  Eilif: Stolz auf unerschrockenes Draufgängertum — „Sofort bück ich mich nach meinem Eisen und hau sie zusammen.“"]], "hint": "Wichtig sind die Gegenpaare (Kriegshandwerk vs. Vorbild Gustav Adolf; Vorsicht vs. Raufen; Zurückhaltung vs. Draufgängertum).", "solution": "(siehe Lehrerexemplar S.10)", "check": "exactLines"}, {"id": "schweiz1", "type": "textarea_keywords", "title": "Schweizerkas: Courages Irrtum", "prompt": "Stelle die ausweglose Lage dar, in die Schweizerkas sich nach dem Überfall der Katholischen (3. Szene) bringt – und erkläre Courages Irrtum.", "keywords": [["zahlmeister", "regimentskasse"], ["katholischen", "überfall"], ["gewissenhaft", "redlich", "korrekt"], ["kasse", "versteckt", "flus", "weg"], ["ausweglos", "hingerichtet", "kopfpreis", "feilsch"]], "hint": "Stichworte: Zahlmeister/Regimentskasse; gewissenhaft; nach Überfall; versteckt/behält Kasse → ausweglos; Courage glaubt Posten sei sicher.", "solution": "Schweizerkas’ Redlichkeit/Gewissenhaftigkeit macht ihn im Chaos des Krieges verwundbar: Als Zahlmeister verwaltet er die Regimentskasse. Nach dem Überfall der Katholischen gerät er unter Druck, weil er die Kasse nicht einfach preisgibt; dadurch wird er festgenommen und erpressbar. Courages Irrtum: Sie hält den Posten fern vom Schlachtgetümmel für sicher – tatsächlich wird gerade seine Korrektheit tödlich."}, {"id": "kattrin1", "type": "textarea_keywords", "title": "Kattrin: Brüder retten + tätliche Bedrohung", "prompt": "Beschreibe Kattrins Bemühen, ihre Brüder zu retten (1. & 3. Szene), und erkläre, warum sie in der 5. Szene die Mutter bedroht.", "keywords": [["entführung", "vereiteln"], ["warnt", "lebensgefahr", "schweizerkas"], ["gurgellaute", "holzplanke"], ["verwundete", "leinenhemden", "verband"]], "hint": "1: Entführung Eilifs vereiteln; 3: Schweizerkas warnen; 5: Planke/Bedrohung, um Mutter zur Hilfe für Verwundete (Leinenhemden) zu zwingen.", "solution": "Kattrin will Eilifs Entführung vereiteln (sie springt vom Wagen und stößt Laute aus) und warnt Schweizerkas verzweifelt vor Lebensgefahr. In der 5. Szene bedroht sie die Mutter mit einer Holzplanke, weil sie sie mit Gewalt zwingen will, Verwundeten zu helfen (Leinenhemden als Verbandmaterial)."}, {"id": "kattrin2", "type": "tableFill", "title": "Gegensätze Kattrin ↔ Mutter Courage", "prompt": "Ergänze die Gegensätze (je 6 Zeilen). Formuliere pro Zeile kurz den Gegensatz.", "rows": [["1", "Kattrin will Eilifs Entführung vereiteln — Mutter Courage ist mit einem Handel beschäftigt."], ["2", "Kattrin warnt Schweizerkas vor Lebensgefahr — Mutter Courage verspielt durch Feilschen die Rettung ihres Sohnes."], ["3", "Kattrin macht sich attraktiv für Männer — Mutter Courage macht die Tochter unansehnlich für Männer."], ["4", "Kattrin will die Mutter mit Gewalt zur Hilfe für Verwundete zwingen — Mutter Courage verweigert jede Hilfeleistung."], ["5", "Kattrin rettet unter Lebensgefahr einen Säugling — Mutter Courage nimmt einem zahlungsunfähigen Kunden den Mantel."], ["6", "Kattrin hofft auf eine Heirat — Mutter Courage hat jede Hoffnung auf einen Schwiegersohn aufgegeben."], ["7", "Kattrin rettet mit ihrem Trommeln die Bewohner Halles — Mutter Courage geht in der Stadt ihren Geschäften nach."]], "hint": "Es sind klare Gegensatz-Paare (Hilfe/Mut vs. Geschäft/Anpassung).", "solution": "(siehe Lehrerexemplar S.12)", "check": "exactLines"}]}, {"id": "kommerz", "title": "Krieg und Geschäft", "ref": "Lehrer-PDF S.13–14", "intro": "Zusammenhang Krieg/Kommerz: Feldwebelvers, Zeugmeister, Lückentext 8. Szene.", "questions": [{"id": "kom1", "type": "textarea_keywords", "title": "Feldwebelvers am Schluss der 1. Szene", "prompt": "Erkläre den ganz konkreten Sinn der Verse: „Will vom Krieg leben / Wird ihm wohl müssen auch was geben.“", "keywords": [["verschmelzung", "krieg", "geschäft"], ["gewerbesteuer", "menschenleben"], ["bezahlt", "männer", "jetzt", "kinder"]], "hint": "Kern: Krieg verlangt „Gewerbesteuer“ in Menschenleben; Courage hat mit Männern bezahlt, nun Kinder.", "solution": "Die Verse zeigen die Verschmelzung von Krieg und Geschäft: Wer vom Krieg leben will, muss ihm auch etwas „geben“ – der Krieg verlangt von seinen Geschäftspartnern eine Art Gewerbesteuer in Menschenleben. Courage hat schon mit ihren Männern bezahlt; jetzt sind ihre Kinder dran."}, {"id": "kom2", "type": "shorttext", "title": "Zeugmeister: Warum verkauft er Munition?", "prompt": "Nenne den Grund (kurz).", "answer": ["Der Zeugmeister braucht Bargeld für die Besäufnisse der Offiziere", "Er braucht Bargeld für die Besäufnisse der Offiziere"], "hint": "Stichwort: Bargeld – Besäufnisse – Offiziere.", "solution": "Der Zeugmeister braucht Bargeld für die Besäufnisse der Offiziere."}, {"id": "kom3", "type": "shorttext", "title": "Zeugmeister: Welche fatalen Folgen hat der Diebstahl?", "prompt": "Formuliere die Folge (1 Satz).", "answer": ["Die gestohlene Mannschaftsmunition fehlt den Evangelischen beim Überfall der Katholischen", "Die Munition fehlt den Evangelischen beim Überfall der Katholischen"], "hint": "Stichworte: Munition fehlt – Evangelische – Überfall – Katholische.", "solution": "Die gestohlene Mannschaftsmunition fehlt den Evangelischen offenbar beim Überfall der Katholischen."}, {"id": "kom4", "type": "cloze", "title": "Lückentext (8. Szene, S. 74–79)", "prompt": "Ergänze die Lücken. (Du kannst sinngemäß schreiben; Kernwörter müssen stimmen.)", "blanks": [{"label": "1", "a": ["der friede ausgebrochen ist"], "hint": "Beginnt mit „der Friede …“.", "sol": "der Friede ausgebrochen ist"}, {"label": "2", "a": ["auch ruiniert bin"], "hint": "„… wenn ich auch …“", "sol": "auch ruiniert bin"}, {"label": "3", "a": ["krieg"], "hint": "Wort: Krieg.", "sol": "Krieg"}, {"label": "4", "a": ["ich sitz auf meine waren"], "hint": "„… und ich sitz …“", "sol": "ich sitz auf meine Waren"}, {"label": "5", "a": ["wo die sold auszahl"], "hint": "„… wo die Sold …“", "sol": "wo die Sold auszahl"}, {"label": "6", "a": ["angeben", "dann zu einem einkauf", "überflüssigen"], "hint": "Koch spricht von „überflüssigen Waren“ und „Angeben“.", "sol": "überflüssigen Waren geraten haben ____ (Angeben)"}, {"label": "7", "a": ["sie sind ein hyänen des schlachtfeldes", "hyänen des schlachtfeldes"], "hint": "Feldprediger: „Sie sind ein …“", "sol": "Sie sind ein Hyänen des Schlachtfeldes."}, {"label": "8", "a": ["kann nix besseres"], "hint": "Koch: „In der Lag können Sie jetzt nix Besseres…“", "sol": "In der Lag können Sie jetzt nix Besseres…"}, {"label": "9", "a": ["vor"], "hint": "„… war sie gewarnt …“ (Schnell los, vor …)", "sol": "vor …"}], "hint": "Halte dich eng an die Textfassung im Lehrerexemplar (S.14).", "solution": "M.C.: Sagen Sie mir nicht, daß der Friede ausgebrochen ist, wo ich eben neue Vorräte eingekauft hab.\nM.C.: Ich bin froh übern Frieden, wenn ich auch ruiniert bin. Wenigstens zwei von den Kindern hätt ich also durchgebracht durch den Krieg.\nM.C.: Der Friede bricht mirn Hals. Ich hab auf den Feldprediger sein Rat neulich noch Vorräte eingekauft. Und jetzt wird sich alles verlaufen, und ich sitz auf meine Waren.\nM.C.: Ich halt nix von Friedensglocken im Moment. Ich seh nicht, wo im Rückstand ist, und wo bleib ich dann mit meinem berühmten Branntwein?\nKoch: … weil Sie die Dame zu einem Einkauf von überflüssigen Waren geraten haben. … weil Sie die Dame zu einem Einkauf von überflüssigen Waren geraten haben. ...\nFeldprediger: Sie sollten sich nicht am Frieden versündigen, Courage! Sie sind ein Hyänen des Schlachtfeldes.\n…\n(gekürzt in der Lösungseinblendung; siehe Lehrerexemplar S.14)"}, {"id": "kom5", "type": "textarea_keywords", "title": "Wie zeigt die 8. Szene Krieg ↔ Geschäft?", "prompt": "Erkläre kurz, wie in der 8. Szene der Zusammenhang sichtbar wird.", "keywords": [["frieden", "ärgert", "absatzmöglichkeiten"], ["vom krieg lebt", "feldprediger"]], "hint": "Kern: Frieden = keine Absatzmöglichkeiten; Feldprediger sagt deutlich: Courage lebt vom Krieg.", "solution": "Im ersten Teil der 8. Szene wird der Zusammenhang besonders deutlich: Courage ärgert sich über den überraschenden Frieden, weil sie nun für ihre Waren keine Absatzmöglichkeiten mehr findet. Der Feldprediger konstatiert ausdrücklich, dass Courage vom Krieg lebt."}]}, {"id": "interesse", "title": "Interesse am Krieg: „Nicht für den Krieg!“", "ref": "Lehrer-PDF S.15", "intro": "Dilemma des Industriearbeiters und Vergleich mit Courage.", "questions": [{"id": "int1", "type": "textarea_keywords", "title": "Dilemma des Industriearbeiters", "prompt": "Zeige am Text: In welchem Dilemma steht der Industriearbeiter?", "keywords": [["alles", "für den krieg verwendbar", "glühlampe"], ["keine kontrolle", "verwendung", "arbeitskraft"], ["mitschuld", "opfer"], ["entweder", "für den krieg arbeiten", "arbeitslos"]], "hint": "Kern: Alles ist kriegsverwendbar; keine Kontrolle; Mitschuld-Frage; Wahl: Krieg arbeiten oder arbeitslos.", "solution": "Der Text zeigt die Verflechtung von Industrieproduktion und Krieg: Selbst die Glühlampe kann für den Krieg verwendet werden. Der Einzelne kontrolliert die Verwendung seiner Arbeitskraft nicht; es entsteht sogar die Frage nach Mitschuld. Dilemma: entweder für den Krieg arbeiten oder arbeitslos sein."}, {"id": "int2", "type": "shorttext", "title": "Vergleich mit Courage (1 Satz)", "prompt": "Wie ist Courages Situation analog?", "answer": ["Auch Mutter Courage befindet sich in dem Dilemma, entweder für den Krieg zu arbeiten oder arbeitslos zu sein", "Sie muss für den Krieg arbeiten oder arbeitslos sein"], "hint": "Formulierung: „entweder für den Krieg arbeiten oder arbeitslos sein“.", "solution": "Auch Mutter Courage befindet sich in dem Dilemma, entweder für den Krieg zu arbeiten oder arbeitslos zu sein."}]}, {"id": "werte", "title": "Krieg und Umkehrung der Werte", "ref": "Lehrer-PDF S.16–17", "intro": "Satire (1. Szene): Aussagen zu Frieden/Krieg; 2. Szene: Bedeutung von Eilifs „Heldentat“.", "questions": [{"id": "sat1", "type": "matchSelect", "title": "Satire 1. Szene: Frieden vs. Krieg", "prompt": "Ordne die Aussagen dem Bereich <strong>Frieden</strong> oder <strong>Krieg</strong> zu (ankreuzen).", "groups": ["Frieden", "Krieg"], "statements": [{"t": "Die Leut sind voll Bosheit.", "g": "Frieden"}, {"t": "Die Leute hintergehen die Werber.", "g": "Frieden"}, {"t": "Es gibt kein Manneswort, kein Treu und Glauben, kein Ehrgefühl.", "g": "Frieden"}, {"t": "Man verliert das Vertrauen in die Menschheit.", "g": "Frieden"}, {"t": "(Frieden:) Chaos / Schlamperei.", "g": "Frieden"}, {"t": "(Krieg:) Moral.", "g": "Krieg"}, {"t": "(Krieg:) schafft Ordnung.", "g": "Krieg"}, {"t": "Ordentliche Listen und Registraturen.", "g": "Krieg"}, {"t": "Das Schuhzeug kommt in Ballen und das Korn in Säcke.", "g": "Krieg"}, {"t": "Mensch und Vieh wird sauber gezählt.", "g": "Krieg"}, {"t": "Ohne Ordnung kein Krieg.", "g": "Krieg"}, {"t": "(Krieg:) Ordnung.", "g": "Krieg"}], "hint": "Krieg = Ordnung/Listen/Zählen; Frieden = Chaos/Schlamperei/Bosheit.", "solution": "Frieden: Bosheit, Hintergehen, kein Treu/Glauben/Ehrgefühl, Vertrauensverlust, Chaos/Schlamperei.\nKrieg: Moral/Ordnung, Listen/Registraturen, Ballen/Säcke, Zählen, „Ohne Ordnung kein Krieg“."}, {"id": "werte2", "type": "clozeMC", "title": "2. Szene: Bedeutung von Eilifs Heldentat", "prompt": "Fülle die vier Deutungen (stichwortartig).", "items": [{"q": "für seine Mutter?", "a": [["gefährdung", "eigenen lebens"], ["lebensgefährdung"]], "hint": "Es geht um Risiko für ihn.", "sol": "Gefährdung des eigenen Lebens."}, {"q": "für den Feldprediger?", "a": [["absolution"], ["mörderisch", "verhalten"]], "hint": "„Absolution“ ist Schlüsselwort.", "sol": "Absolution für mörderisches Verhalten."}, {"q": "für den Feldhauptmann?", "a": [["heldentat"], ["held"]], "hint": "1 Wort.", "sol": "Heldentat."}, {"q": "für Eilif selbst?", "a": [["not kennt kein gebot"], ["rechtfertigt", "verbrecherisch"]], "hint": "Formel: „Not kennt kein Gebot“.", "sol": "Er rechtfertigt sein verbrecherisches Verhalten mit „Not kennt kein Gebot“."}]}]}, {"id": "tugenden", "title": "Tödliche Tugenden (Salomon-Lied)", "ref": "Lehrer-PDF S.18", "intro": "Verbindung Lied ↔ Szene; Lehre für Publikum; Widerspruch zur Schluss-Handlung der Szene.", "questions": [{"id": "tug0a", "type": "textarea_keywords", "title": "Verbindung Lied ↔ Szene", "prompt": "Lege dar, welche Verbindung das Lied (Salomo-Song) mit dem szenischen Zusammenhang hat.", "keywords": [["lied", "song", "salomo"], ["szene", "zusammenhang"], ["kommentar", "unterbrechung", "iron"]], "hint": "Stichworte: Salomo‑Song/Song; szenischer Zusammenhang; Kommentar/Unterbrechung/ironische Brechung.", "solution": "(Im Lehrerexemplar ist dazu keine ausgeschriebene Modelllösung enthalten. Orientiere dich am szenischen Kontext und an Brechts epischem Theater.)"}, {"id": "tug0b", "type": "textarea_keywords", "title": "Lehre für das Publikum", "prompt": "Welche Lehre soll das Publikum aus dem Solomon-Lied ziehen?", "keywords": [["lehre"], ["publikum", "zuschauer"], ["kritisch", "nachdenken", "gesellschaft"]], "hint": "Tipp: nicht „moralische Tugenden sind schädlich“ wörtlich übernehmen, sondern kritisch/dialektisch lesen.", "solution": "(Im Lehrerexemplar ist dazu keine ausgeschriebene Modelllösung enthalten. Formuliere eine eigene, begründete Lehre.)"}, {"id": "tug1", "type": "textarea_keywords", "title": "Deutung & Lehre", "prompt": "Lege dar: (1) Verbindung Lied–Szene, (2) Lehre fürs Publikum, (3) Widerspruch zur noblen Handlung am Schluss.", "keywords": [["warnt", "moralisch", "tugendhaft"], ["noble handlung", "vollzieht"], ["nicht für bare münze"], ["keine schädlichen tugenden"], ["gesellschaft", "beschaffen", "unter die räder"]], "hint": "Kern: Song warnt vor Tugendhaftigkeit (ironisch), Courage handelt nobel; Brecht will kritisches Nachdenken über Gesellschaftsbedingungen.", "solution": "Der Salomo-Song warnt (ironisch) vor moralischen Entscheidungen und tugendhaftem Verhalten, während Mutter Courage am Schluss eine wirklich noble Handlung vollzieht. Brecht will, dass wir die Lehre des Songs nicht für bare Münze nehmen (es gibt keine „schädlichen Tugenden“), sondern darüber nachdenken, wie eine Gesellschaft beschaffen sein muss, damit Menschen mit moralisch wertvollen Tugenden nicht unter die Räder kommen."}]}, {"id": "symbolik", "title": "Symbolik", "ref": "Lehrer-PDF S.19", "intro": "Allgemeine Symbolbedeutung + spezifische Bedeutung im Stück.", "questions": [{"id": "sym0", "type": "textarea_keywords", "title": "Symbolik gesamt", "prompt": "Beschreibe die allgemeine und die aufs Stück bezogene Bedeutung der abgebildeten Symbole (gesamt).", "keywords": [["wagen"], ["helm"], ["haus"], ["zeit", "tick"], ["stock", "macht"], ["schuhe", "schuhzeug"]], "hint": "Nenne mehrere Symbole und unterscheide jeweils allgemein vs. im Stück (Planwagen, Helm, Haus, Ticken, Stock, Schuhzeug, Aufstieg, Menschen …).", "solution": "Allgemein: Symbole verweisen über sich hinaus. Im Stück (Auswahl):\n- Wagen: Fortbewegungsmittel/Wohnung; im Stück endlose Wanderschaft, Niedergang, falsche Hoffnung.\n- Helm: Schutz/Unverwundbarkeit; im Stück Ehre/Strafen der Offiziere.\n- Haus: sicherer Ort/Heimat; Kontrast zur Wanderschaft.\n- Ticken: Zeit/Endlichkeit; Lebensuhr/Todessymbol.\n- Stock: Macht/Autorität/Druck.\n- Schuhzeug: staatliche Macht/militärische Tugenden.\n- Aufstieg/Leiter: Verbindung Himmel–Erde; 11. Szene: Kattrin aufs Dach.\n(Detailantworten siehe die Einzelaufgaben unten.)"}, {"id": "sym1", "type": "textarea_keywords", "title": "Wagen (Planwagen)", "prompt": "Beschreibe: (a) allgemein, (b) im Stück.", "keywords": [["fortbewegungsmittel", "aufbewahrungsort", "wohnung"], ["zieht", "aus dem nichts", "ins nichts"], ["endlose wanderschaft"], ["symbolisiert", "niedergang", "ewige falsche hoffnung"]], "hint": "Stichworte: Fortbewegungsmittel/Aufbewahrung/Wohnung; endlose Wanderschaft; Niedergang; falsche Hoffnung.", "solution": "Allgemein: Fortbewegungsmittel/Aufbewahrung/Wohnung. Im Stück: zieht aus dem Nichts ins Nichts; Symbol für endlose Wanderschaft, Niedergang der Familie Fierling und die ewige falsche Hoffnung Courages."}, {"id": "sym2", "type": "textarea_keywords", "title": "Menschen (als Symbol)", "prompt": "Beschreibe: (a) allgemein, (b) im Stück.", "keywords": [["symbole", "individuen"], ["kriegsromane", "zeigen", "frontdienste", "leisten", "müssen"]], "hint": "Stichwort: Menschen als Symbole für Individuen; im Stück: jeder muss Frondienste/Frontdienste leisten.", "solution": "Allgemein: Menschen symbolisieren Individuen. Im Stück: zeigt, dass jeder seine Frondienste leisten muss."}, {"id": "sym3", "type": "textarea_keywords", "title": "Ticken (Uhr/Zeichen)", "prompt": "Beschreibe: (a) allgemein, (b) im Stück.", "keywords": [["zeit", "todessymbol"], ["lebensuhr"], ["tickt", "unaufhaltsam", "todessymbol"]], "hint": "Zeit/Endlichkeit.", "solution": "Allgemein: Symbol für Zeit und Endlichkeit (Todessymbol). Im Stück: die tickende „Lebensuhr“ verweist auf Unaufhaltsamkeit und Bedrohung."}, {"id": "sym4", "type": "textarea_keywords", "title": "Helm", "prompt": "Beschreibe: (a) allgemein, (b) im Stück.", "keywords": [["unverwundbarkeit", "stärke"], ["schutzsymbol"], ["ehrer", "strafen", "offiziere"]], "hint": "Schutz/Unverwundbarkeit; im Stück: Ehre/Strafen der Offiziere.", "solution": "Allgemein: Zeichen der Unverwundbarkeit und Stärke (Schutz). Im Stück: Symbolisiert in der 2. Szene Ehre und Strafen der Offiziere."}, {"id": "sym5", "type": "textarea_keywords", "title": "Stock (Stab)", "prompt": "Beschreibe: (a) allgemein, (b) im Stück.", "keywords": [["macht", "druck"], ["autorität", "schicksals", "todessymbol"], ["ordnung", "durchsetzung"]], "hint": "Macht/Autorität; im Stück: Ordnung/Schicksalsfunktion.", "solution": "Allgemein: Symbol für Macht und Druck. Im Stück: steht für Autorität/Schicksalsfunktion (Ordnung und Durchsetzung, Todessymbol)."}, {"id": "sym6", "type": "textarea_keywords", "title": "Schuhzeug (Schuhe)", "prompt": "Beschreibe: (a) allgemein, (b) im Stück.", "keywords": [["staatliche macht", "männlicher kraft", "militärische tugenden"], ["simbol", "ballen", "kriegsgewalt"]], "hint": "Stichwort: staatliche Macht / militärische Tugenden.", "solution": "Allgemein: Symbol staatlicher Macht, männlicher Kraft und militärischer Tugenden. Im Stück: Sinnbild für Kriegsgewalt (vgl. Ordnung/Listen/„in Ballen“)."}, {"id": "sym7", "type": "textarea_keywords", "title": "Aufstieg (Leiter/Dach)", "prompt": "Beschreibe: (a) allgemein, (b) im Stück.", "keywords": [["ausstieg", "aufstieg", "religiös"], ["himmel", "erde"], ["11. szene", "kattrin", "dach", "überlegenheit"]], "hint": "Himmel↔Erde; 11. Szene: Kattrin steigt aufs Dach (Überlegenheit/Blick).", "solution": "Allgemein: Symbol des Aufstiegs und der stufenweisen Steigerung; religiös: Verbindung von Himmel und Erde. Im Stück: In der 11. Szene steigt Kattrin aufs Dach; die Leiter/der Aufstieg verdeutlicht ihre Überlegenheit/den Überblick."}, {"id": "sym8", "type": "textarea_keywords", "title": "Haus", "prompt": "Beschreibe: (a) allgemein, (b) im Stück.", "keywords": [["sinnbild", "sicherer ort"], ["bewahrung", "mensch"], ["gesellschaft", "ordnung", "wanderschaft"], ["heimat", "sesshaftigkeit", "geborgenheit"]], "hint": "Sicherer Ort/Heimat/Geborgenheit; im Stück kontrastiert zu Wanderschaft.", "solution": "Allgemein: Sinnbild der kosmischen Ordnung; sicherer Ort der Bewahrung des Menschen. Im Stück: Symbol für Heimat/Sesshaftigkeit/Geborgenheit – im Kontrast zu Courages Wanderschaft."}]}, {"id": "theater", "title": "Theaterbegriffe & Brechts episches Theater", "ref": "Lehrer-PDF S.20–23", "intro": "Nichtaristotelisches, episches, dialektisches Theater; Verfremdungseffekt; zentrale Ziele.", "questions": [{"id": "th1", "type": "flashQuiz", "title": "Begriffscheck (10 Karten)", "prompt": "Gib die zentrale Idee in 1–2 Sätzen an.", "cards": [{"term": "Katharsis", "acc": [["reinigung", "furcht", "mitleid"], ["läuterung"]], "hint": "Reinigung/Läuterung des Zuschauers durch Furcht & Mitleid.", "sol": "Aristotelischer Zweck der Tragödie: Läuterung/Reinigung des Zuschauers durch Furcht und Mitleid."}, {"term": "Nichtaristotelisches Theater", "acc": [["verstand", "zuschauer"], ["wissen", "hilfsbereitschaft"], ["theater der einfühlung", "ablösen"]], "hint": "Zielt auf Verstand statt Einfühlung; ersetzt Furcht/Mitleid.", "sol": "Brecht verlagert den Schwerpunkt vom Theater der Einfühlung hin zu einem Theater, das auf den Verstand zielt; statt Furcht/Mitleid eher Wissensbegierde/Hilfsbereitschaft."}, {"term": "Episches Theater", "acc": [["erzähl", "elemente"], ["songs", "chöre", "erzähler"], ["spruchbänder", "plakate", "projektion"], ["was", "wie"]], "hint": "Erzählerisches + Kommentare; Aufmerksamkeit auf das Wie.", "sol": "Theaterform mit erzählerischen Elementen (Songs, Chöre, Erzählerfiguren, Kommentare, Spruchbänder/Projektionen), die den Zuschauer aktiv macht und Aufmerksamkeit auf das „Wie“ lenkt."}, {"term": "Verfremdungseffekt", "acc": [["gewohnte", "ungewohnt"], ["distanz"], ["illusion", "brechen"]], "hint": "Gewohntes ungewohnt präsentieren, Distanz/Illusionsbruch.", "sol": "Gewohntes wird ungewohnt präsentiert, um Neues zu entdecken; Illusion wird gebrochen, damit der Zuschauer kritisch-distanzierend denkt."}, {"term": "Dialektisches Theater", "acc": [["in gegensätzen"], ["widersprüche", "prüfen"], ["gesellschaft", "blickwinkel"]], "hint": "In Gegensätzen denken; Widersprüche sichtbar machen.", "sol": "Theater, das in Gegensätzen denkt: Widersprüche prüfen, gesellschaftliche Zustände aus ungewohntem Blickwinkel sehen und daraus lernen."}, {"term": "Mimesis", "acc": [["nachahmung"], ["identifikation"]], "hint": "Nachahmung/Identifikation.", "sol": "Nachahmung bzw. Identifikation mit dem Gezeigten (Brecht will das gerade nicht als Ziel)."}, {"term": "Szenenfolge bei Brecht", "acc": [["locker"], ["keine akteinteilung"], ["eigenleben"]], "hint": "Lose Szenenfolge, Eigenleben, keine Akteinteilung.", "sol": "Bei Brecht eher lose Szenenfolge ohne klassische Akteinteilung; Szenen haben stärkeres Eigenleben."}, {"term": "Ziel beim Publikum", "acc": [["mitdenk"], ["staunt", "abwägt", "kritisch"], ["nicht genießen"]], "hint": "Mitdenkender Zuschauer statt bloß genießender.", "sol": "Ein mitdenkender Zuschauer, der staunt, abwägt und kritisch urteilt – nicht bloß genießend."}, {"term": "Schauspielerforderung", "acc": [["reflexion"], ["zeigt", "bewertet"], ["nicht hineinversetzen"]], "hint": "Zeigen + bewerten; nicht „hineinversetzen“.", "sol": "Der Darsteller soll ständig reflektieren: Rolle/Handlungen zeigen und zugleich bewerten, nicht völlig in sie „hineinschlüpfen“."}, {"term": "Marx-Prämisse (kurz)", "acc": [["gesellschaftliche sein", "bewusstsein"], ["sein bestimmt bewusstsein"]], "hint": "„Das gesellschaftliche Sein bestimmt das Bewusstsein.“", "sol": "Brecht folgt der Prämisse: Das gesellschaftliche Sein bestimmt das Bewusstsein."}]}]}, {"id": "verfremdung", "title": "Verfremdungseffekt (V-Effekt)", "ref": "Lehrer-PDF S.22–23 (Text teils gekürzt in Extraktion)", "intro": "Definition, Ziel und Wirkung der Verfremdung im epischen Theater.", "questions": [{"id": "v1", "type": "textarea_keywords", "title": "Definition & Zweck", "prompt": "Erkläre den Verfremdungseffekt (V‑Effekt): Was ist der Kern, und wozu wird er eingesetzt?", "keywords": [["vertraut", "neues licht", "ungewohnt"], ["illusion", "brechen", "distanz"], ["widersprueche", "sichtbar"], ["reflexion", "nachdenken"]], "hint": "Stichworte: Gewohntes ungewohnt; Illusionsbruch/Distanz; Widersprüche sichtbar; Zuschauer reflektiert.", "solution": "Kern: Vertraute Dinge sollen in neuem Licht erscheinen (Gewohntes wird ungewohnt), damit Widersprüche sichtbar werden. V‑Effekte werden eingesetzt, um die Illusion des Theaters zu brechen, Distanz herzustellen und den Zuschauer zum kritischen Nachdenken/Reflektieren über das Dargestellte anzuregen."}]}]};
  const STORAGE_KEY = "mc_interaktiv_full_v1";

  const teacherImages = ["lehrer_p01.png", "lehrer_p02.png", "lehrer_p03.png", "lehrer_p04.png", "lehrer_p05.png", "lehrer_p06.png", "lehrer_p07.png", "lehrer_p08.png", "lehrer_p09.png", "lehrer_p10.png", "lehrer_p11.png", "lehrer_p12.png", "lehrer_p13.png", "lehrer_p14.png", "lehrer_p15.png", "lehrer_p16.png", "lehrer_p17.png", "lehrer_p18.png", "lehrer_p19.png", "lehrer_p20.png", "lehrer_p21.png", "lehrer_p22.png", "lehrer_p23.png"];
  const studentImages = ["schueler_p01.png", "schueler_p02.png", "schueler_p03.png", "schueler_p04.png", "schueler_p05.png", "schueler_p06.png", "schueler_p07.png", "schueler_p08.png", "schueler_p09.png", "schueler_p10.png", "schueler_p11.png", "schueler_p12.png", "schueler_p13.png", "schueler_p14.png", "schueler_p15.png", "schueler_p16.png", "schueler_p17.png", "schueler_p18.png", "schueler_p19.png", "schueler_p20.png", "schueler_p21.png"];

  const elNav = document.getElementById("nav");
  const elSections = document.getElementById("sections");
  const elSearch = document.getElementById("search");
  const elProgress = document.getElementById("progressPill");
  const btnReset = document.getElementById("btnReset");
  const btnToggleTeacher = document.getElementById("btnToggleTeacher");

  const galleryTeacher = document.getElementById("galleryTeacher");
  const galleryStudent = document.getElementById("galleryStudent");
  document.getElementById("badgeTeacherPages").textContent = teacherImages.length + " Seiten";
  document.getElementById("badgeStudentPages").textContent = studentImages.length + " Seiten";

  const state = loadState();
  let teacherMode = !!state.teacherMode;

  function loadState(){
    try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}") || {}; }
    catch(e) { return {}; }
  }
  function saveState(){
    state.teacherMode = teacherMode;
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    updateProgress();
  }

  function norm(s){
    return (s||"")
      .toLowerCase()
      .replaceAll("ä","ae").replaceAll("ö","oe").replaceAll("ü","ue").replaceAll("ß","ss")
      .replace(/\s+/g," ")
      .replace(/[“”„"']/g,"")
      .replace(/[\.,;:!?()\[\]{}]/g,"")
      .trim();
  }

  function levenshtein(a,b){
    a = norm(a); b = norm(b);
    const m=a.length, n=b.length;
    if(!m) return n;
    if(!n) return m;
    const dp = Array.from({length:m+1}, ()=>Array(n+1).fill(0));
    for(let i=0;i<=m;i++) dp[i][0]=i;
    for(let j=0;j<=n;j++) dp[0][j]=j;
    for(let i=1;i<=m;i++) {
      for(let j=1;j<=n;j++) {
        const cost = a[i-1]===b[j-1] ? 0 : 1;
        dp[i][j] = Math.min(dp[i-1][j]+1, dp[i][j-1]+1, dp[i-1][j-1]+cost);
      }
    }
    return dp[m][n];
  }

  function roughlyEquals(user, target){
    const u = norm(user);
    const t = norm(target);
    if(!u || !t) return false;
    if(u === t) return true;
    const maxLen = Math.max(u.length, t.length);
    if(maxLen <= 18) return levenshtein(u,t) <= 2;
    if(maxLen <= 40) return levenshtein(u,t) <= 4;
    return u.includes(t) || t.includes(u);
  }

  function containsAllKeywords(user, keywordGroups){
    const u = norm(user);
    if(!u) return false;
    return keywordGroups.every(group => {
      const g = Array.isArray(group) ? group : [group];
      return g.some(k => u.includes(norm(k)));
    });
  }

  function checkAnswer(q, userValue){
    if(q.type === "shorttext") {
      const accepted = Array.isArray(q.answer) ? q.answer : [q.answer];
      return accepted.some(a => roughlyEquals(userValue, a));
    }
    if(q.type === "textarea_keywords") {
      const groups = q.keywords || [];
      const needed = Math.min(groups.length, Math.max(2, Math.ceil(groups.length * 0.6)));
      let ok = 0;
      for (const g of groups) if(containsAllKeywords(userValue, [g])) ok++;
      return ok >= needed;
    }
    if(q.type === "tableFill") {
      const expected = q.rows.map(r => r[1]);
      if(!Array.isArray(userValue) || userValue.length !== expected.length) return false;
      for(let i=0;i<expected.length;i++) {
        if(!(roughlyEquals(userValue[i], expected[i]) || norm(userValue[i]).includes(norm(expected[i]).slice(0, Math.min(40, norm(expected[i]).length))))) return false;
      }
      return true;
    }
    if(q.type === "multiSelect") {
      const sel = userValue || [];
      const ans = q.answer || [];
      const aSet = new Set(ans);
      const sSet = new Set(sel);
      if(aSet.size !== sSet.size) return false;
      for (const a of aSet) if(!sSet.has(a)) return false;
      return true;
    }
    if(q.type === "matchSelect") {
      const mapping = userValue || {};
      for(let i=0;i<q.statements.length;i++) {
        const should = q.statements[i].g;
        if(mapping[i] !== should) return false;
      }
      return true;
    }
    if(q.type === "clozeMC") {
      if(!Array.isArray(userValue) || userValue.length !== q.items.length) return false;
      for(let i=0;i<q.items.length;i++) {
        const item = q.items[i];
        const acc = item.a;
        const u = userValue[i] || "";
        let ok=false;
        for (const a of acc){
          if(Array.isArray(a)) ok = containsAllKeywords(u, a);
          else ok = roughlyEquals(u, a);
          if(ok) break;
        }
        if(!ok) return false;
      }
      return true;
    }
    if(q.type === "cloze") {
      if(!Array.isArray(userValue) || userValue.length !== q.blanks.length) return false;
      for(let i=0;i<q.blanks.length;i++) {
        const b = q.blanks[i];
        const acc = b.a || [];
        const u = userValue[i] || "";
        let ok = false;
        for (const a of acc){
          if(roughlyEquals(u,a) || norm(u).includes(norm(a))) { ok=true; break; }
        }
        if(!ok) return false;
      }
      return true;
    }
    if(q.type === "flashQuiz") {
      if(!Array.isArray(userValue) || userValue.length !== q.cards.length) return false;
      for(let i=0;i<q.cards.length;i++) {
        const card = q.cards[i];
        const u = userValue[i] || "";
        if(!containsAllKeywords(u, card.acc)) return false;
      }
      return true;
    }
    return false;
  }

  function getAttempts(qid){
    state.attempts = state.attempts || {};
    return state.attempts[qid] || 0;
  }
  function setAttempts(qid, n){
    state.attempts = state.attempts || {};
    state.attempts[qid] = n;
    saveState();
  }
  function setSolved(qid, solved){
    state.solved = state.solved || {};
    state.solved[qid] = !!solved;
    saveState();
  }
  function isSolved(qid){ return !!(state.solved && state.solved[qid]); }

  function storeAnswer(qid, val){
    state.answers = state.answers || {};
    state.answers[qid] = val;
    saveState();
  }
  function loadAnswer(qid){ return state.answers && state.answers[qid]; }

  function updateProgress(){
    const allQ = DATA.sections.flatMap(s => (s.questions||[]).map(q => q.id));
    const solved = allQ.filter(id => isSolved(id)).length;
    const pct = allQ.length ? Math.round((solved / allQ.length) * 100) : 0;
    elProgress.textContent = `Fortschritt: ${pct}%`;
  }

  function scrollToId(id){
    const el = document.getElementById(id);
    if(el) el.scrollIntoView({behavior:"smooth", block:"start"});
  }

  function buildGalleries() {
    function addToGallery(list, basePath, target) {
      list.forEach((name, idx) => {
        const card = document.createElement("div");
        card.className = "pagecard";
        const img = document.createElement("img");
        img.src = basePath + name;
        img.alt = name;
        img.title = "Seite öffnen";
        img.addEventListener("click", () => {
          const w = window.open("", "_blank");
          w.document.write(`<title>Seite ${idx+1}</title><img src="${basePath+name}" style="max-width:100%;height:auto;margin:0;display:block">`);
        });
        const label = document.createElement("div");
        label.className = "small";
        label.textContent = "Seite " + (idx+1);
        card.appendChild(img);
        card.appendChild(label);
        target.appendChild(card);
      });
    }
    addToGallery(teacherImages, "assets/images_teacher/", galleryTeacher);
    addToGallery(studentImages, "assets/images_student/", galleryStudent);
  }

  function build() {
    elNav.innerHTML = "";

    const fixed = [
      ["start","Start"],
      ["material_lehrer","Material Lehrer‑PDF"],
      ["material_schueler","Material Schüler‑PDF"]
    ];
    fixed.forEach(([id,label]) => {
      const a = document.createElement("a");
      a.href = "#" + id;
      a.textContent = label;
      a.dataset.section = id;
      a.addEventListener("click",(e)=>{ e.preventDefault(); scrollToId(id); });
      elNav.appendChild(a);
    });

    DATA.sections.forEach(section => {
      const a = document.createElement("a");
      a.href = "#" + section.id;
      a.textContent = section.title;
      a.dataset.section = section.id;
      a.addEventListener("click", (e)=>{ e.preventDefault(); scrollToId(section.id); });
      elNav.appendChild(a);
    });

    elSections.innerHTML = "";
    DATA.sections.forEach(section => {
      const sec = document.createElement("section");
      sec.className = "card";
      sec.id = section.id;

      const head = document.createElement("div");
      head.className = "section-head";
      head.innerHTML = `
        <div>
          <h2>${section.title}</h2>
          <div class="small">${(section.ref||"")}${section.intro ? " · " + section.intro : ""}</div>
        </div>
        <div class="meta">
          <span class="badge">${(section.questions||[]).length} Aufgaben</span>
          <span class="badge">Synonyme aktiv</span>
        </div>
      `;
      sec.appendChild(head);

      (section.questions||[]).forEach((q, idx) => {
        sec.appendChild(renderQuestion(q, idx));
      });

      elSections.appendChild(sec);
    });

    updateProgress();
    refreshActiveNav();
  }

  function renderQuestion(q, idx){
    const wrap = document.createElement("div");
    wrap.className = "q";
    wrap.id = q.id;

    const solved = isSolved(q.id);
    const attempts = getAttempts(q.id);

    const title = document.createElement("div");
    title.className = "q__title";
    title.textContent = `${idx+1}) ${q.title}`;
    wrap.appendChild(title);

    const prompt = document.createElement("div");
    prompt.className = "q__prompt";
    prompt.innerHTML = q.prompt;
    wrap.appendChild(prompt);

    const inputArea = document.createElement("div");
    wrap.appendChild(inputArea);

    const feedback = document.createElement("div");
    feedback.className = "feedback";
    feedback.style.display = "none";
    wrap.appendChild(feedback);

    const solution = document.createElement("div");
    solution.className = "solution";
    solution.innerHTML = `<pre></pre>`;
    wrap.appendChild(solution);

    const controls = document.createElement("div");
    controls.className = "controls";
    wrap.appendChild(controls);

    const btnCheck = document.createElement("button");
    btnCheck.className = "btn";
    btnCheck.textContent = solved ? "Erledigt ✓" : "Prüfen";
    btnCheck.disabled = solved;
    controls.appendChild(btnCheck);

    const attemptInfo = document.createElement("span");
    attemptInfo.className = "kbd";
    attemptInfo.textContent = `Fehlversuche: ${attempts}`;
    controls.appendChild(attemptInfo);

    const btnShowSol = document.createElement("button");
    btnShowSol.className = "btn btn--ghost";
    btnShowSol.textContent = "Modelllösung anzeigen";
    btnShowSol.addEventListener("click", ()=> solution.classList.toggle("show"));
    controls.appendChild(btnShowSol);

    let getUserValue = () => null;
    let setUserValue = (v) => {};

    if(q.type === "shorttext") {
      const inp = document.createElement("input");
      inp.className = "input";
      inp.type = "text";
      inp.placeholder = "Antwort…";
      inputArea.appendChild(inp);
      getUserValue = () => inp.value;
      setUserValue = v => inp.value = v || "";
    }

    if(q.type === "textarea_keywords") {
      const ta = document.createElement("textarea");
      ta.placeholder = "Antwort… (Stichworte/Sätze)";
      inputArea.appendChild(ta);
      getUserValue = () => ta.value;
      setUserValue = v => ta.value = v || "";
    }

    if(q.type === "tableFill") {
      const table = document.createElement("table");
      table.className = "table";
      table.innerHTML = `<thead><tr><th>Nr.</th><th>Deine Antwort</th></tr></thead>`;
      const tb = document.createElement("tbody");
      const inputs = [];
      q.rows.forEach(r => {
        const tr = document.createElement("tr");
        const td1 = document.createElement("td");
        td1.textContent = r[0];
        const td2 = document.createElement("td");
        const inp = document.createElement("textarea");
        inp.style.minHeight = "70px";
        inp.placeholder = "…";
        td2.appendChild(inp);
        tr.appendChild(td1);
        tr.appendChild(td2);
        tb.appendChild(tr);
        inputs.push(inp);
      });
      table.appendChild(tb);
      inputArea.appendChild(table);
      getUserValue = () => inputs.map(i => i.value);
      setUserValue = arr => (arr||[]).forEach((v,i)=>{ if(inputs[i]) inputs[i].value = v; });
    }

    if(q.type === "multiSelect") {
      const box = document.createElement("div");
      box.className = "checkgrid";
      const checks = [];
      q.options.forEach(opt => {
        const item = document.createElement("div");
        item.className = "checkitem";
        const id = `${q.id}_${opt.replace(/\W+/g,'_')}`;
        item.innerHTML = `<label><input type="checkbox" id="${id}"> <span>${opt}</span></label>`;
        const chk = item.querySelector("input");
        checks.push({opt, chk});
        box.appendChild(item);
      });
      inputArea.appendChild(box);
      getUserValue = () => checks.filter(c=>c.chk.checked).map(c=>c.opt);
      setUserValue = arr => {
        const set = new Set(arr||[]);
        checks.forEach(c => c.chk.checked = set.has(c.opt));
      };
    }

    if(q.type === "matchSelect") {
      const box = document.createElement("div");
      box.className = "checkgrid";
      const selects = [];
      q.statements.forEach((st) => {
        const item = document.createElement("div");
        item.className = "checkitem";
        const sel = document.createElement("select");
        ["— wählen —", ...q.groups].forEach(g => {
          const o = document.createElement("option");
          o.value = g === "— wählen —" ? "" : g;
          o.textContent = g;
          sel.appendChild(o);
        });
        item.appendChild(sel);
        const p = document.createElement("div");
        p.className = "small";
        p.style.marginTop = "6px";
        p.textContent = st.t;
        item.appendChild(p);
        box.appendChild(item);
        selects.push(sel);
      });
      inputArea.appendChild(box);
      getUserValue = () => {
        const map = {};
        selects.forEach((s,i)=> map[i] = s.value);
        return map;
      };
      setUserValue = map => {
        if(!map) return;
        selects.forEach((s,i)=> s.value = map[i] || "");
      };
    }

    if(q.type === "clozeMC") {
      const inputs = [];
      q.items.forEach(it => {
        const card = document.createElement("div");
        card.className = "mini-card";
        card.innerHTML = `<div class="small" style="margin-bottom:6px">${it.q}</div>`;
        const inp = document.createElement("input");
        inp.className = "input";
        inp.placeholder = "Antwort…";
        card.appendChild(inp);
        inputArea.appendChild(card);
        inputs.push(inp);
      });
      getUserValue = () => inputs.map(i=>i.value);
      setUserValue = arr => (arr||[]).forEach((v,i)=>{ if(inputs[i]) inputs[i].value = v; });
    }

    if(q.type === "cloze") {
      const inputs = [];
      const grid = document.createElement("div");
      grid.className = "grid2";
      q.blanks.forEach(b => {
        const card = document.createElement("div");
        card.className = "mini-card";
        card.innerHTML = `<div class="small" style="margin-bottom:6px">Lücke ${b.label}</div>`;
        const inp = document.createElement("input");
        inp.className = "input";
        inp.placeholder = "…";
        card.appendChild(inp);
        grid.appendChild(card);
        inputs.push(inp);
      });
      inputArea.appendChild(grid);
      getUserValue = () => inputs.map(i=>i.value);
      setUserValue = arr => (arr||[]).forEach((v,i)=>{ if(inputs[i]) inputs[i].value = v; });
    }

    if(q.type === "flashQuiz") {
      const inputs = [];
      q.cards.forEach(card => {
        const c = document.createElement("div");
        c.className = "mini-card";
        c.innerHTML = `<div class="q__title">${card.term}</div><div class="small" style="margin-bottom:8px">Erkläre kurz.</div>`;
        const ta = document.createElement("textarea");
        ta.placeholder = "Deine Erklärung…";
        ta.style.minHeight = "90px";
        c.appendChild(ta);
        inputArea.appendChild(c);
        inputs.push(ta);
      });
      getUserValue = () => inputs.map(i=>i.value);
      setUserValue = arr => (arr||[]).forEach((v,i)=>{ if(inputs[i]) inputs[i].value = v; });
    }

    const saved = loadAnswer(q.id);
    if(saved !== undefined) {
      try { setUserValue(saved); } catch(e){}
    }

    function showFeedback(kind, msg){
      feedback.style.display = "block";
      feedback.classList.remove("ok","bad","hint");
      feedback.classList.add(kind);
      feedback.innerHTML = msg;
    }

    function setSolutionText(){
      const pre = solution.querySelector("pre");
      const sol = (q.solution && String(q.solution).trim()) ? q.solution : "Keine ausgeschriebene Modelllösung im Dokument vorhanden.";
      pre.textContent = sol;
    }
    setSolutionText();
    if(teacherMode) solution.classList.add("show");

    btnCheck.addEventListener("click", () => {
      const val = getUserValue();
      storeAnswer(q.id, val);

      const ok = checkAnswer(q, val);

      if(ok) {
        setSolved(q.id, true);
        showFeedback("ok", "✓ Richtig.");
        btnCheck.textContent = "Erledigt ✓";
        btnCheck.disabled = true;
        attemptInfo.textContent = `Fehlversuche: ${getAttempts(q.id)}`;
        return;
      }

      let a = getAttempts(q.id) + 1;
      setAttempts(q.id, a);
      attemptInfo.textContent = `Fehlversuche: ${a}`;

      if(a === 1) {
        showFeedback("bad", "✗ Falsch. Versuche es nochmals.");
      } else if(a === 2) {
        const hint = (q.hint && String(q.hint).trim()) ? q.hint : "Achte auf zentrale Stichworte aus dem Abschnitt.";
        showFeedback("hint", `✗ Noch nicht. <strong>Hinweis:</strong> ${hint}`);
      } else {
        showFeedback("bad", "✗ Wieder falsch. Hier ist die Modelllösung:");
        solution.classList.add("show");
      }
    });

    return wrap;
  }

  function refreshActiveNav(){
    const ids = ["start","material_lehrer","material_schueler", ...DATA.sections.map(s=>s.id)];
    let bestId = ids[0];
    let bestTop = Infinity;
    ids.forEach(id => {
      const el = document.getElementById(id);
      if(!el) return;
      const rect = el.getBoundingClientRect();
      const top = Math.abs(rect.top - 90);
      if(top < bestTop) { bestTop = top; bestId = id; }
    });
    Array.from(elNav.querySelectorAll("a")).forEach(a => {
      a.classList.toggle("active", a.dataset.section === bestId);
    });
  }

  document.addEventListener("scroll", () => refreshActiveNav(), {passive:true});

  elSearch.addEventListener("input", () => {
    const q = norm(elSearch.value);
    const links = Array.from(elNav.querySelectorAll("a"));
    links.forEach(a => {
      const s = norm(a.textContent);
      a.style.display = (!q || s.includes(q)) ? "" : "none";
    });
  });

  btnReset.addEventListener("click", () => {
    if(!confirm("Wirklich alles zurücksetzen (Fortschritt, Fehlversuche, Antworten)?")) return;
    localStorage.removeItem(STORAGE_KEY);
    location.reload();
  });

  btnToggleTeacher.addEventListener("click", () => {
    teacherMode = !teacherMode;
    saveState();
    document.querySelectorAll(".solution").forEach(el => {
      if(teacherMode) el.classList.add("show"); else el.classList.remove("show");
    });
  });

  buildGalleries();
  build();
  updateProgress();
})();
